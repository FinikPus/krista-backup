.. _tar:

Tar
===

Создаёт бэкап в формате ``tar.gz`` или ``tar.bz2``. Для бэкапа создаётся
``shapshot list``, который содержит путь к соответствующему бэкапу и
хранит для каждого файла время изменения, его размер и имя.

Файл добавляется в инкрементальный бэкап,
если он не был создан или у старого файла было изменено время изменения/размер.

.. csv-table:: 
   :widths: 15, 30, 20
   :header: "название", "описание", "значение"

    "basename", "уникальное имя для связанных действий, не должно быть началом другого basename, используется для имени результата", "пример: названия последних двух папок, например home_user, var_log, etc"
    "check_level_list_only","проверять только наличие snaphot листа; имеет смысл использовать, если сервер жёстко ограничен по памяти и предыдущий уровень бэкапа хранится в другом месте", "false (стандартное значение)"
    "exclusions","файлы, которые стоит игнорировать", ""
    "use_re_in_patterns","использовать регулярные выражения (false для unix wildcard)", "false (стандартное значение)"
    "compression","уровень сжатия", "3 (стандартное значение)"
    "src_path","путь к содержимому, бэкап которого нужно выполнить", "путь к директории"
    "dest_path","уровень сжатия", "путь к директории"
    "level","уровень бэкапа", "число  (0 - стандартное значение)"
    "level_folders","название директорий в порядке соответствующих уровню", "список через запятую"
    "extension","расширение архива", "gz (стандартное значение), bz2"
    "use_absolute_path","использовать относительные или абсолютные пути", "false (стандартное значение)"
    "list_extension","расширение snapshot листа", "list (стандартное значение)"
    "log_tar_files","логгировать добавленные и исключенные из бэкапа файлы", "False (стандартное значение)"


Пример:
~~~~~~~

.. code-block:: yaml

  tarjob_0level_etc:
    basename: etc
    check_level_list_only: false
    compression: 3
    exclusions: '*/index/*, */logs/archived/.indexed'
    use_re_in_patterns: false
    src_path: /etc
    dest_path: /backup
    level: 0
    level_folders: 0,1
    descr: бэкап файлов /etc 0-го уровня
    type: tar

Примечание:
~~~~~~~~~~~

На данный момент явно не прописана логика для 2-го уровня бэкапа,
поэтому рекомендуется использовать только 0 и 1 уровень.
